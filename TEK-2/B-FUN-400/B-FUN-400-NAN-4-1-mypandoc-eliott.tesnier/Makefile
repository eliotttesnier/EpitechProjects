##
## EPITECH PROJECT, 2025
## B-FUN-400-NAN-4-1-bswolfram-eliott.tesnier
## File description:
## Makefile
##

NAME = mypandoc

MAIN = src/Main

C_STYLE = coding-style-reports.log

all: build copy

build:
	@echo "$(BLUE)á’¥ğŸ”§á’§ Building $(NAME)...$(NC)"
	stack build --allow-different-user
	@echo "$(GREEN)á’¥âœ…á’§ Build successful!$(NC)"

copy:
	@echo "$(YELLOW)á’¥ğŸ“‹á’§ Copying binary...$(NC)"
	cp `stack path --local-install-root`/bin/$(NAME) .
	@echo "$(GREEN)á’¥âœ…á’§ Binary copied successfully!$(NC)"

clean:
	@echo "$(RED)á’¥ğŸ§¹á’§ Cleaning build files...$(NC)"
	stack clean
	@echo "$(GREEN)á’¥âœ…á’§ Clean complete!$(NC)"

fclean: clean
	@echo "$(RED)á’¥ğŸ—‘ï¸á’§ Removing $(NAME)...$(NC)"
	rm -f $(NAME)
	@echo "$(RED)á’¥ğŸ—‘ï¸á’§ Removing $(C_STYLE)...$(NC)"
	rm -f $(C_STYLE)
	@echo "$(RED)á’¥ğŸ—‘ï¸á’§ Removing $(MAIN)...$(NC)"
	rm -f $(MAIN)
	@echo "$(GREEN)á’¥âœ…á’§ Full clean complete!$(NC)"

re: fclean all

tests_run:
	@echo "$(YELLOW)á’¥ğŸ§ªá’§ Running tests...$(NC)"
	stack test --allow-different-user
	@rm -rf src/Main
	@echo "$(GREEN)á’¥âœ…á’§ Tests completed!$(NC)"

functional_tests: all
	@echo "$(YELLOW)á’¥ğŸ§ªá’§ Running functional tests...$(NC)"
	@python3 tests/functional/Tester.py

.PHONY: all build copy clean fclean re tests_run functional_tests
